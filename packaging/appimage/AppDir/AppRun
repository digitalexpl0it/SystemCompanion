#!/bin/bash

# System Companion AppImage Launcher
# This script launches the System Companion application

# Get the directory where this script is located
HERE="$(dirname "$(readlink -f "${0}")")"

# Set up environment variables
export PYTHONPATH="${HERE}/usr/lib/python3.11/site-packages:${PYTHONPATH}"
export PATH="${HERE}/usr/bin:${PATH}"
export LD_LIBRARY_PATH="${HERE}/usr/lib:${LD_LIBRARY_PATH}"
export XDG_DATA_DIRS="${HERE}/usr/share:${XDG_DATA_DIRS}"
export XDG_CONFIG_DIRS="${HERE}/etc/xdg:${XDG_CONFIG_DIRS}"

# Set up GTK and other desktop environment variables
export GTK_DATA_PREFIX="${HERE}"
export GTK_EXE_PREFIX="${HERE}"
export GTK_PATH="${HERE}"

# Set up icon theme
export XDG_DATA_HOME="${HERE}/usr/share"
export XDG_CONFIG_HOME="${HERE}/etc/xdg"

# Create necessary directories for the application
mkdir -p "${HOME}/.config/system-companion"
mkdir -p "${HOME}/.local/share/system-companion/logs"
mkdir -p "${HOME}/.local/share/system-companion/data"

# Launch the application
exec "${HERE}/usr/bin/python3" "${HERE}/usr/lib/python3.11/site-packages/system_companion/main.py" "$@" 